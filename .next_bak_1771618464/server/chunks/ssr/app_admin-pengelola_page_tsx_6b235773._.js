module.exports=[65307,a=>{"use strict";a.s(["default",()=>v]);var b=a.i(87924),c=a.i(54161),d=a.i(40695),e=a.i(3130),f=a.i(5522),g=a.i(17171),h=a.i(46893),i=a.i(23290),j=a.i(11785),k=a.i(63645),l=a.i(85668),m=a.i(95490),n=a.i(5151),o=a.i(15618),p=a.i(14548),q=a.i(81560),r=a.i(38246),s=a.i(72131);function t(a){return{...a,features:[...a.features],demo_images:[...a.demo_images],cta_links:a.cta_links?{...a.cta_links}:void 0}}async function u(a,b){try{let b=await a.json();if("string"==typeof b.message&&b.message.trim().length>0)return b.message}catch{}return b}function v(){let a=(0,i.useCaseStudies)(),[v,w]=(0,s.useState)(a),[x,y]=(0,s.useState)(0),[z,A]=(0,s.useState)(""),[B,C]=(0,s.useState)(!1);(0,s.useEffect)(()=>{w(a),y(b=>Math.min(b,Math.max(a.length-1,0)))},[a]);let D=(0,s.useMemo)(()=>JSON.stringify(v)!==JSON.stringify(a),[v,a]),E=v[x],F=(a,b)=>{w(c=>c.map((c,d)=>d===x?{...c,[a]:b}:c))},G=(a,b)=>{let c=b.split("\n").map(a=>a.trim()).filter(a=>a.length>0);w(b=>b.map((b,d)=>d===x?{...b,[a]:c}:b))},H=(a,b)=>{w(c=>c.map((c,d)=>{if(d!==x)return c;let e=c.cta_links??{"let's talk":"","read case study":""};return{...c,cta_links:{...e,[a]:b}}}))},I=async(a,b)=>{let c=a.target.files?.[0];if(a.target.value="",!c)return;let d=(0,k.validateUploadImageFile)(c);if(d)return void A(d);try{let a=await (0,k.fileToOptimizedDataUrl)(c,{maxBytes:32e4,maxDimension:1600});if((0,k.estimateImageStringBytes)(a)>42e4)return void A(`Gambar "${c.name}" masih terlalu besar. Coba file lain yang lebih kecil.`);F(b,a),A(`"${c.name}" berhasil diupload dan dioptimasi. Klik Simpan Template.`)}catch{A(`Gagal membaca file "${c.name}".`)}},J=async a=>{let b=Array.from(a.target.files??[]);if(a.target.value="",0!==b.length){if((E?.demo_images.length??0)+b.length>8)return void A("Maksimal 8 gambar demo per template.");for(let a of b){let b=(0,k.validateUploadImageFile)(a);if(b)return void A(b)}try{let a=await Promise.all(b.map(a=>(0,k.fileToOptimizedDataUrl)(a,{maxBytes:24e4,maxDimension:1440})));if(a.some(a=>(0,k.estimateImageStringBytes)(a)>42e4))return void A("Ada gambar demo yang masih terlalu besar setelah optimasi. Coba file lebih kecil.");w(b=>b.map((b,c)=>c===x?{...b,demo_images:[...b.demo_images,...a]}:b)),A(`${a.length} gambar demo berhasil diupload dan dioptimasi.`)}catch{A("Gagal membaca salah satu file gambar demo.")}}},K=async()=>{if(!D)return void A("Tidak ada perubahan untuk disimpan.");C(!0),A("Menyimpan data template...");try{let a=await fetch("/api/cms/templates",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({templates:v})});if(!a.ok){let b=await u(a,"Gagal simpan template.");throw Error(b)}let b=(await a.json()).data??v;w(b),(0,j.writeCaseStudiesToStorage)(b),A("Template berhasil disimpan.")}catch(a){A(a instanceof Error?a.message:"Gagal menyimpan template.")}finally{C(!1)}},L=(a,b)=>{let c="up"===b?a-1:a+1;c<0||c>=v.length||(w(b=>{let d=[...b],[e]=d.splice(a,1);return d.splice(c,0,e),d}),y(c),A("Urutan template diperbarui."))};return(0,b.jsx)("main",{className:"min-h-screen bg-muted/30 px-4 py-6 md:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-4 rounded-xl border bg-background p-5 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tamplateku Admin Pengelola"}),(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Kelola Template Tampil"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Fokus mengelola data template yang tampil di halaman pilih template."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(r.default,{href:"/browse-template",target:"_blank",children:"Lihat Halaman Template"})}),(0,b.jsx)(d.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(r.default,{href:"/admin",children:"Buka Admin Utama"})}),(0,b.jsxs)(d.Button,{onClick:K,disabled:!D||B,children:[(0,b.jsx)(p.Save,{className:"mr-2 h-4 w-4"}),B?"Menyimpan...":"Simpan Template"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsx)(e.CardTitle,{className:"text-sm",children:"Status Perubahan"})}),(0,b.jsxs)(e.CardContent,{className:"flex items-center gap-3",children:[(0,b.jsx)(c.Badge,{variant:D?"destructive":"secondary",children:D?"Belum Disimpan":"Sudah Tersimpan"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:z||"Siap mengubah template."})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[320px_1fr]",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{children:"Daftar Template"}),(0,b.jsx)(e.CardDescription,{children:"Pilih template untuk diubah."})]}),(0,b.jsxs)(d.Button,{size:"sm",onClick:()=>{var a;let b=(a=v.length+1,{...t(j.defaultCaseStudiesContent[0]),id:crypto.randomUUID(),name:`Template ${a}`,project_title:"Template baru siap pakai",description:"Deskripsi singkat template baru.",testimonial:"",founder_name:"",position:"",status_label:"Siap Dipakai",is_best_seller:!1});w(a=>[...a,b]),y(v.length),A("Template baru ditambahkan.")},children:[(0,b.jsx)(o.Plus,{className:"mr-1 h-4 w-4"})," Tambah"]})]})}),(0,b.jsx)(e.CardContent,{className:"space-y-2",children:v.map((a,c)=>(0,b.jsx)("div",{className:`w-full rounded-md border px-3 py-2 text-left transition ${x===c?"border-primary bg-primary/5":"hover:border-muted-foreground/40"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>y(c),className:"w-full text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:a.name}),(0,b.jsx)("p",{className:"line-clamp-2 text-xs text-muted-foreground",children:a.project_title})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>L(c,"up"),className:"rounded p-1 text-muted-foreground hover:bg-muted hover:text-foreground disabled:opacity-40","aria-label":`Pindahkan ${a.name} ke atas`,disabled:0===c,children:(0,b.jsx)(m.ArrowUp,{className:"h-4 w-4"})}),(0,b.jsx)("button",{type:"button",onClick:()=>L(c,"down"),className:"rounded p-1 text-muted-foreground hover:bg-muted hover:text-foreground disabled:opacity-40","aria-label":`Pindahkan ${a.name} ke bawah`,disabled:c===v.length-1,children:(0,b.jsx)(l.ArrowDown,{className:"h-4 w-4"})}),(0,b.jsx)("button",{type:"button",onClick:()=>(a=>{if(v.length<=1)return void A("Minimal harus ada 1 template.");w(b=>b.filter((b,c)=>c!==a)),y(a=>Math.max(0,Math.min(a,v.length-2))),A("Template berhasil dihapus.")})(c),className:"rounded p-1 text-muted-foreground hover:bg-muted hover:text-destructive","aria-label":`Hapus ${a.name}`,children:(0,b.jsx)(q.Trash2,{className:"h-4 w-4"})})]})]})},a.id??`${a.name}-${c}`))})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{children:"Form Ubah Template"}),(0,b.jsx)(e.CardDescription,{children:"Kelola isi kartu dan detail template."})]}),(0,b.jsxs)(d.Button,{size:"sm",variant:"outline",onClick:()=>{if(!E)return;let a=t(E);a.id=crypto.randomUUID(),a.name=`${a.name} Copy`,w(b=>[...b,a]),y(v.length),A("Template berhasil diduplikasi.")},children:[(0,b.jsx)(n.Copy,{className:"mr-1 h-4 w-4"})," Duplikat"]})]})}),(0,b.jsx)(e.CardContent,{className:"space-y-3",children:E?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Nama Template"}),(0,b.jsx)(f.Input,{value:E.name,onChange:a=>F("name",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Link Studi Kasus"}),(0,b.jsx)(f.Input,{value:E.case_study_link,onChange:a=>F("case_study_link",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Label Status"}),(0,b.jsx)(f.Input,{value:E.status_label??"Siap Dipakai",onChange:a=>F("status_label",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{className:"block",children:"Unggulan"}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!E.is_best_seller,onChange:a=>{var b;return b=a.target.checked,void w(a=>a.map((a,c)=>c===x?{...a,is_best_seller:b}:a))}}),"Tandai sebagai template unggulan"]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Judul Proyek"}),(0,b.jsx)(f.Input,{value:E.project_title,onChange:a=>F("project_title",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Deskripsi"}),(0,b.jsx)(h.Textarea,{rows:3,value:E.description,onChange:a=>F("description",a.target.value)})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Gambar Utama"}),(0,b.jsx)(f.Input,{type:"file",accept:"image/*",onChange:a=>void I(a,"main_image_src")}),(0,b.jsx)("img",{src:E.main_image_src,alt:`${E.name} main image preview`,className:"h-24 w-full rounded border object-cover"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Logo"}),(0,b.jsx)(f.Input,{type:"file",accept:"image/*",onChange:a=>void I(a,"logo_src")}),(0,b.jsx)("div",{className:"bg-muted/40 flex h-24 items-center justify-center rounded border p-2",children:(0,b.jsx)("img",{src:E.logo_src,alt:`${E.name} logo preview`,className:"max-h-16 w-auto object-contain"})})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Nama Pemilik"}),(0,b.jsx)(f.Input,{value:E.founder_name??"",onChange:a=>F("founder_name",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Jabatan"}),(0,b.jsx)(f.Input,{value:E.position??"",onChange:a=>F("position",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Link Proyek"}),(0,b.jsx)(f.Input,{value:E.project_link??"",onChange:a=>F("project_link",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"URL Download"}),(0,b.jsx)(f.Input,{value:E.download_url??"",onChange:a=>F("download_url",a.target.value),placeholder:"https://github.com/owner/repo atau link file zip"})]})]}),(0,b.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Tombol Konsultasi"}),(0,b.jsx)(f.Input,{value:E.cta_links?.["let's talk"]??"",onChange:a=>H("let's talk",a.target.value)})]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Tombol Lihat Studi Kasus"}),(0,b.jsx)(f.Input,{value:E.cta_links?.["read case study"]??"",onChange:a=>H("read case study",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Gambar Testimoni"}),(0,b.jsx)(f.Input,{type:"file",accept:"image/*",onChange:a=>void I(a,"test_img")}),(0,b.jsx)("img",{src:E.test_img??"",alt:`${E.name} testimonial image preview`,className:"h-24 w-full rounded border object-cover"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Testimonial"}),(0,b.jsx)(h.Textarea,{rows:3,value:E.testimonial??"",onChange:a=>F("testimonial",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Fitur (1 baris = 1 item)"}),(0,b.jsx)(h.Textarea,{rows:4,value:E.features.join("\n"),onChange:a=>G("features",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Gambar Demo"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-3",children:E.demo_images.map((a,c)=>(0,b.jsx)("img",{src:a,alt:`${E.name} demo ${c+1}`,className:"h-20 w-full rounded border object-cover"},`${E.id??x}-${c}`))}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(d.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{G("demo_images",""),A("Semua gambar demo pada template ini dihapus.")},children:"Hapus Semua Gambar Demo"})}),(0,b.jsx)(f.Input,{type:"file",accept:"image/*",multiple:!0,onChange:J})]})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tidak ada template untuk diedit."})})]})]})]})})}}];

//# sourceMappingURL=app_admin-pengelola_page_tsx_6b235773._.js.map