module.exports=[5522,a=>{"use strict";a.s(["Input",()=>d]);var b=a.i(87924),c=a.i(97895);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}},34633,a=>{"use strict";a.s(["SectionHeading",()=>g]);var b=a.i(87924),c=a.i(97895),d=a.i(72131);let e={sm:{heading:"text-xl sm:text-2xl leading-tight",description:"text-sm leading-snug",spacing:"space-y-1.5"},md:{heading:"text-2xl sm:text-3xl md:text-4xl leading-tight",description:"text-sm sm:text-base leading-snug",spacing:"space-y-2"},lg:{heading:"text-3xl sm:text-4xl md:text-5xl leading-tight",description:"text-base sm:text-md leading-snug",spacing:"space-y-3 sm:space-y-4"},xl:{heading:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl leading-tight",description:"text-lg sm:text-xl leading-snug",spacing:"space-y-4 sm:space-y-6"}},f={left:"text-left",center:"text-center",right:"text-right"},g=(0,d.forwardRef)(({heading:a,description:d,size:g="md",align:h="center",className:i,headingClassName:j,as:k="h2",id:l,showDescriptionToScreenReaders:m=!1,...n},o)=>{let p=e[g],q=f[h];return(0,b.jsxs)("header",{ref:o,className:(0,c.cn)("z-10",p.spacing,q,i),...n,children:[(0,b.jsx)(k,{id:l,className:(0,c.cn)("text-foreground font-semibold",p.heading,"center"===h&&"md:mx-auto",j),children:a}),d&&(0,b.jsx)("p",{className:(0,c.cn)("text-muted-foreground",p.description,"center"===h&&"md:mx-auto",!m&&"sr-only"),"aria-live":"polite",children:d})]})});g.displayName="SectionHeading"},63394,a=>{"use strict";a.s(["default",()=>j]);var b=a.i(87924),c=a.i(34633),d=a.i(40695),e=a.i(5522),f=a.i(38246),g=a.i(50944),h=a.i(72131);function i(){let a=(0,g.useSearchParams)(),[i,j]=(0,h.useState)("request"),[k,l]=(0,h.useState)(a.get("email")??""),[m,n]=(0,h.useState)(""),[o,p]=(0,h.useState)(""),[q,r]=(0,h.useState)(""),[s,t]=(0,h.useState)(!1),[u,v]=(0,h.useState)(!1),[w,x]=(0,h.useState)(""),[y,z]=(0,h.useState)(""),A=async(a=!1)=>{if(x(""),!k.trim())return x("Email wajib diisi."),!1;a?v(!0):t(!0);try{let b=await fetch("/api/otp/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:k,purpose:"RESET_PASSWORD"})}),c=await b.json();if(!b.ok){if(429===b.status&&c.retryAfterSeconds)return x(`Terlalu sering meminta OTP. Coba lagi dalam ${c.retryAfterSeconds} detik.`),!1;return x(c.message??"Gagal mengirim OTP."),!1}return j("verify"),z(a?"OTP baru telah dikirim. Cek inbox/spam email kamu.":"Jika email terdaftar, OTP telah dikirim. Lanjutkan verifikasi di bawah."),!0}catch{return x("Tidak bisa terhubung ke server."),!1}finally{a?v(!1):t(!1)}},B=async a=>{a.preventDefault(),z(""),await A(!1)},C=async a=>{if(a.preventDefault(),x(""),z(""),!k.trim())return void x("Email wajib diisi.");if(!/^\d{6}$/.test(m))return void x("Kode OTP harus 6 digit.");if(o.length<8)return void x("Password baru minimal 8 karakter.");if(o!==q)return void x("Konfirmasi password tidak cocok.");t(!0);try{let a=await fetch("/api/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:k,purpose:"RESET_PASSWORD",otp:m})}),b=await a.json();if(!a.ok||!b.ok||!b.resetToken)return void x(b.message??"Verifikasi OTP gagal.");let c=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:b.resetToken,newPassword:o})}),d=await c.json();if(!c.ok||!d.ok)return void x(d.message??"Gagal reset password.");j("done"),z("Password berhasil diubah. Silakan login dengan password baru.")}catch{x("Tidak bisa terhubung ke server.")}finally{t(!1)}};return(0,b.jsx)("div",{className:"min-h-screen w-full",children:(0,b.jsx)("main",{id:"main-content",children:(0,b.jsx)("div",{className:"mx-auto flex min-h-screen max-w-6xl flex-col px-5 pt-[116px] pb-16 md:pt-[128px] md:pb-24 lg:pt-[140px]",children:(0,b.jsxs)("section",{className:"mx-auto w-full max-w-xl space-y-8","aria-labelledby":"forgot-password-heading",children:[(0,b.jsx)(c.SectionHeading,{badge:"Password Recovery",heading:"Lupa Password",description:"Minta OTP ke email, verifikasi kode, lalu set password baru akun kamu.",size:"md",align:"center",as:"h1",id:"forgot-password-heading",className:"mb-4",showDescriptionToScreenReaders:!0}),y?(0,b.jsx)("div",{className:"rounded-md border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-700 dark:text-emerald-300",children:y}):null,w?(0,b.jsx)("div",{className:"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:w}):null,"request"===i?(0,b.jsxs)("form",{className:"space-y-4 md:space-y-5","aria-label":"Request reset OTP",onSubmit:B,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"forgot-email",className:"text-sm font-medium text-heading",children:"Email"}),(0,b.jsx)(e.Input,{id:"forgot-email",type:"email",name:"email",value:k,onChange:a=>l(a.target.value),placeholder:"Masukkan email akun kamu",autoComplete:"email",required:!0})]}),(0,b.jsx)(d.Button,{type:"submit",className:"w-full",disabled:s,children:s?"Mengirim OTP...":"Kirim OTP Reset Password"})]}):null,"verify"===i?(0,b.jsxs)("form",{className:"space-y-4 md:space-y-5","aria-label":"Verify reset OTP",onSubmit:C,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"reset-email",className:"text-sm font-medium text-heading",children:"Email"}),(0,b.jsx)(e.Input,{id:"reset-email",type:"email",name:"email",value:k,onChange:a=>l(a.target.value),placeholder:"Masukkan email akun kamu",autoComplete:"email",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"reset-otp",className:"text-sm font-medium text-heading",children:"Kode OTP"}),(0,b.jsx)(e.Input,{id:"reset-otp",type:"text",name:"otp",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,value:m,onChange:a=>n(a.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Masukkan 6 digit OTP",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"new-password",className:"text-sm font-medium text-heading",children:"Password Baru"}),(0,b.jsx)(e.Input,{id:"new-password",type:"password",name:"newPassword",value:o,onChange:a=>p(a.target.value),placeholder:"Minimal 8 karakter",autoComplete:"new-password",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"confirm-password",className:"text-sm font-medium text-heading",children:"Konfirmasi Password Baru"}),(0,b.jsx)(e.Input,{id:"confirm-password",type:"password",name:"confirmPassword",value:q,onChange:a=>r(a.target.value),placeholder:"Ulangi password baru",autoComplete:"new-password",required:!0})]}),(0,b.jsx)(d.Button,{type:"submit",className:"w-full",disabled:s,children:s?"Memproses...":"Verifikasi OTP & Ubah Password"}),(0,b.jsx)(d.Button,{type:"button",variant:"outline",className:"w-full",onClick:()=>{A(!0)},disabled:u,children:u?"Mengirim Ulang...":"Kirim Ulang OTP"})]}):null,"done"===i?(0,b.jsx)(d.Button,{asChild:!0,className:"w-full",children:(0,b.jsx)(f.default,{href:"/login",children:"Kembali ke Login"})}):null,(0,b.jsxs)("p",{className:"text-center text-sm text-label",children:["Ingat password?"," ",(0,b.jsx)(f.default,{href:"/login",className:"text-primary hover:underline",children:"Login di sini"})]})]})})})})}function j(){return(0,b.jsx)(h.Suspense,{fallback:null,children:(0,b.jsx)(i,{})})}}];

//# sourceMappingURL=_d215f6d3._.js.map