(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23750,e=>{"use strict";e.s(["Input",()=>i]);var a=e.i(43476),t=e.i(47163);function i(e){let{className:i,type:s,...r}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,t.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),...r})}},62959,e=>{"use strict";e.s(["SectionHeading",()=>n]);var a=e.i(43476),t=e.i(47163),i=e.i(71645);let s={sm:{heading:"text-xl sm:text-2xl leading-tight",description:"text-sm leading-snug",spacing:"space-y-1.5"},md:{heading:"text-2xl sm:text-3xl md:text-4xl leading-tight",description:"text-sm sm:text-base leading-snug",spacing:"space-y-2"},lg:{heading:"text-3xl sm:text-4xl md:text-5xl leading-tight",description:"text-base sm:text-md leading-snug",spacing:"space-y-3 sm:space-y-4"},xl:{heading:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl leading-tight",description:"text-lg sm:text-xl leading-snug",spacing:"space-y-4 sm:space-y-6"}},r={left:"text-left",center:"text-center",right:"text-right"},n=(0,i.forwardRef)((e,i)=>{let{heading:n,description:l,size:d="md",align:o="center",className:m,headingClassName:u,as:c="h2",id:p,showDescriptionToScreenReaders:x=!1,...g}=e,h=s[d],f=r[o];return(0,a.jsxs)("header",{ref:i,className:(0,t.cn)("z-10",h.spacing,f,m),...g,children:[(0,a.jsx)(c,{id:p,className:(0,t.cn)("text-foreground font-semibold",h.heading,"center"===o&&"md:mx-auto",u),children:n}),l&&(0,a.jsx)("p",{className:(0,t.cn)("text-muted-foreground",h.description,"center"===o&&"md:mx-auto",!x&&"sr-only"),"aria-live":"polite",children:l})]})});n.displayName="SectionHeading"},72519,e=>{"use strict";e.s(["default",()=>o]);var a=e.i(43476),t=e.i(62959),i=e.i(67881),s=e.i(23750),r=e.i(22016),n=e.i(18566),l=e.i(71645);function d(){var e;let d=(0,n.useSearchParams)(),[o,m]=(0,l.useState)("request"),[u,c]=(0,l.useState)(null!=(e=d.get("email"))?e:""),[p,x]=(0,l.useState)(""),[g,h]=(0,l.useState)(""),[f,b]=(0,l.useState)(""),[v,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),[j,T]=(0,l.useState)(""),[P,S]=(0,l.useState)(""),N=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(T(""),!u.trim())return T("Email wajib diisi."),!1;e?k(!0):y(!0);try{let t=await fetch("/api/otp/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,purpose:"RESET_PASSWORD"})}),i=await t.json();if(!t.ok){var a;if(429===t.status&&i.retryAfterSeconds)return T("Terlalu sering meminta OTP. Coba lagi dalam ".concat(i.retryAfterSeconds," detik.")),!1;return T(null!=(a=i.message)?a:"Gagal mengirim OTP."),!1}return m("verify"),S(e?"OTP baru telah dikirim. Cek inbox/spam email kamu.":"Jika email terdaftar, OTP telah dikirim. Lanjutkan verifikasi di bawah."),!0}catch(e){return T("Tidak bisa terhubung ke server."),!1}finally{e?k(!1):y(!1)}},O=async e=>{e.preventDefault(),S(""),await N(!1)},C=async e=>{if(e.preventDefault(),T(""),S(""),!u.trim())return void T("Email wajib diisi.");if(!/^\d{6}$/.test(p))return void T("Kode OTP harus 6 digit.");if(g.length<8)return void T("Password baru minimal 8 karakter.");if(g!==f)return void T("Konfirmasi password tidak cocok.");y(!0);try{var a,t;let e=await fetch("/api/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,purpose:"RESET_PASSWORD",otp:p})}),i=await e.json();if(!e.ok||!i.ok||!i.resetToken)return void T(null!=(a=i.message)?a:"Verifikasi OTP gagal.");let s=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:i.resetToken,newPassword:g})}),r=await s.json();if(!s.ok||!r.ok)return void T(null!=(t=r.message)?t:"Gagal reset password.");m("done"),S("Password berhasil diubah. Silakan login dengan password baru.")}catch(e){T("Tidak bisa terhubung ke server.")}finally{y(!1)}};return(0,a.jsx)("div",{className:"min-h-screen w-full",children:(0,a.jsx)("main",{id:"main-content",children:(0,a.jsx)("div",{className:"mx-auto flex min-h-screen max-w-6xl flex-col px-5 pt-[116px] pb-16 md:pt-[128px] md:pb-24 lg:pt-[140px]",children:(0,a.jsxs)("section",{className:"mx-auto w-full max-w-xl space-y-8","aria-labelledby":"forgot-password-heading",children:[(0,a.jsx)(t.SectionHeading,{badge:"Password Recovery",heading:"Lupa Password",description:"Minta OTP ke email, verifikasi kode, lalu set password baru akun kamu.",size:"md",align:"center",as:"h1",id:"forgot-password-heading",className:"mb-4",showDescriptionToScreenReaders:!0}),P?(0,a.jsx)("div",{className:"rounded-md border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-700 dark:text-emerald-300",children:P}):null,j?(0,a.jsx)("div",{className:"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:j}):null,"request"===o?(0,a.jsxs)("form",{className:"space-y-4 md:space-y-5","aria-label":"Request reset OTP",onSubmit:O,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"forgot-email",className:"text-sm font-medium text-heading",children:"Email"}),(0,a.jsx)(s.Input,{id:"forgot-email",type:"email",name:"email",value:u,onChange:e=>c(e.target.value),placeholder:"Masukkan email akun kamu",autoComplete:"email",required:!0})]}),(0,a.jsx)(i.Button,{type:"submit",className:"w-full",disabled:v,children:v?"Mengirim OTP...":"Kirim OTP Reset Password"})]}):null,"verify"===o?(0,a.jsxs)("form",{className:"space-y-4 md:space-y-5","aria-label":"Verify reset OTP",onSubmit:C,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"reset-email",className:"text-sm font-medium text-heading",children:"Email"}),(0,a.jsx)(s.Input,{id:"reset-email",type:"email",name:"email",value:u,onChange:e=>c(e.target.value),placeholder:"Masukkan email akun kamu",autoComplete:"email",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"reset-otp",className:"text-sm font-medium text-heading",children:"Kode OTP"}),(0,a.jsx)(s.Input,{id:"reset-otp",type:"text",name:"otp",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,value:p,onChange:e=>x(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Masukkan 6 digit OTP",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"new-password",className:"text-sm font-medium text-heading",children:"Password Baru"}),(0,a.jsx)(s.Input,{id:"new-password",type:"password",name:"newPassword",value:g,onChange:e=>h(e.target.value),placeholder:"Minimal 8 karakter",autoComplete:"new-password",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"confirm-password",className:"text-sm font-medium text-heading",children:"Konfirmasi Password Baru"}),(0,a.jsx)(s.Input,{id:"confirm-password",type:"password",name:"confirmPassword",value:f,onChange:e=>b(e.target.value),placeholder:"Ulangi password baru",autoComplete:"new-password",required:!0})]}),(0,a.jsx)(i.Button,{type:"submit",className:"w-full",disabled:v,children:v?"Memproses...":"Verifikasi OTP & Ubah Password"}),(0,a.jsx)(i.Button,{type:"button",variant:"outline",className:"w-full",onClick:()=>{N(!0)},disabled:w,children:w?"Mengirim Ulang...":"Kirim Ulang OTP"})]}):null,"done"===o?(0,a.jsx)(i.Button,{asChild:!0,className:"w-full",children:(0,a.jsx)(r.default,{href:"/login",children:"Kembali ke Login"})}):null,(0,a.jsxs)("p",{className:"text-center text-sm text-label",children:["Ingat password?"," ",(0,a.jsx)(r.default,{href:"/login",className:"text-primary hover:underline",children:"Login di sini"})]})]})})})})}function o(){return(0,a.jsx)(l.Suspense,{fallback:null,children:(0,a.jsx)(d,{})})}}]);